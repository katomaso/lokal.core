version: "3.8"

networks:
  mail:
    name: mail

services:
  mailhog:
    container_name: mailhog
    image: mailhog/mailhog:latest
    networks:
      - traefik
      - mail
    labels:
      traefik.enable: "true"
      traefik.http.routers.mailhog.entrypoints: websecure
      traefik.http.routers.mailhog.rule: Host(`{{subdomain__mailhog}}.{{primary_domain}}`)
      traefik.http.routers.mailhog.tls: "true"
      traefik.http.services.mailhog.loadbalancer.server.port: 8025
      traefik.http.routers.mailhog.tls.certresolver: {{cert_resolver}}
      traefik.http.routers.mailhog.middlewares: traefik-auth
    restart: unless-stopped

networks:
  traefik:
    external: true
